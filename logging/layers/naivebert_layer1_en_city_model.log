2020-08-12 22:40:39,881 - PyTorch version 1.4.0 available.
2020-08-12 22:40:40,408 - loading configuration file https://s3.amazonaws.com/models.huggingface.co/bert/bert-base-uncased-config.json from cache at /home/junliu/.cache/torch/transformers/4dad0251492946e18ac39290fcfe91b89d370fee250efe9521476438fe8ca185.7156163d5fdc189c3016baca0775ffce230789d7fa2a42ef516483e4ca884517
2020-08-12 22:40:40,409 - Model config BertConfig {
  "architectures": [
    "BertForMaskedLM"
  ],
  "attention_probs_dropout_prob": 0.1,
  "hidden_act": "gelu",
  "hidden_dropout_prob": 0.1,
  "hidden_size": 768,
  "initializer_range": 0.02,
  "intermediate_size": 3072,
  "layer_norm_eps": 1e-12,
  "max_position_embeddings": 512,
  "model_type": "bert",
  "num_attention_heads": 12,
  "num_hidden_layers": 12,
  "output_hidden_states": true,
  "pad_token_id": 0,
  "type_vocab_size": 2,
  "vocab_size": 30522
}

2020-08-12 22:40:40,818 - loading file https://s3.amazonaws.com/models.huggingface.co/bert/bert-base-uncased-vocab.txt from cache at /home/junliu/.cache/torch/transformers/26bc1ad6c0ac742e9b52263248f6d0f00068293b33709fae12320c0e35ccfbbb.542ce4285a40d23a559526243235df47c5f75c197f04f37d1a0c124c32c9a084
2020-08-12 22:40:40,998 - loading weights file https://cdn.huggingface.co/bert-base-uncased-pytorch_model.bin from cache at /home/junliu/.cache/torch/transformers/f2ee78bdd635b758cc0a12352586868bef80e47401abe4c4fcc3832421e7338b.36ca03ab34a1a5d5fa7bc3d03d55c4fa650fed07220e2eeebc06ce58d0e9a157
2020-08-13 01:16:05,877 - loading configuration file https://s3.amazonaws.com/models.huggingface.co/bert/bert-base-uncased-config.json from cache at /home/junliu/.cache/torch/transformers/4dad0251492946e18ac39290fcfe91b89d370fee250efe9521476438fe8ca185.7156163d5fdc189c3016baca0775ffce230789d7fa2a42ef516483e4ca884517
2020-08-13 01:16:05,878 - Model config BertConfig {
  "architectures": [
    "BertForMaskedLM"
  ],
  "attention_probs_dropout_prob": 0.1,
  "hidden_act": "gelu",
  "hidden_dropout_prob": 0.1,
  "hidden_size": 768,
  "initializer_range": 0.02,
  "intermediate_size": 3072,
  "layer_norm_eps": 1e-12,
  "max_position_embeddings": 512,
  "model_type": "bert",
  "num_attention_heads": 12,
  "num_hidden_layers": 12,
  "output_hidden_states": true,
  "pad_token_id": 0,
  "type_vocab_size": 2,
  "vocab_size": 30522
}

2020-08-13 01:16:06,253 - loading file https://s3.amazonaws.com/models.huggingface.co/bert/bert-base-uncased-vocab.txt from cache at /home/junliu/.cache/torch/transformers/26bc1ad6c0ac742e9b52263248f6d0f00068293b33709fae12320c0e35ccfbbb.542ce4285a40d23a559526243235df47c5f75c197f04f37d1a0c124c32c9a084
2020-08-13 01:16:06,493 - loading weights file https://cdn.huggingface.co/bert-base-uncased-pytorch_model.bin from cache at /home/junliu/.cache/torch/transformers/f2ee78bdd635b758cc0a12352586868bef80e47401abe4c4fcc3832421e7338b.36ca03ab34a1a5d5fa7bc3d03d55c4fa650fed07220e2eeebc06ce58d0e9a157
2020-08-13 01:39:20,480 - loading configuration file https://s3.amazonaws.com/models.huggingface.co/bert/bert-base-uncased-config.json from cache at /home/junliu/.cache/torch/transformers/4dad0251492946e18ac39290fcfe91b89d370fee250efe9521476438fe8ca185.7156163d5fdc189c3016baca0775ffce230789d7fa2a42ef516483e4ca884517
2020-08-13 01:39:20,481 - Model config BertConfig {
  "architectures": [
    "BertForMaskedLM"
  ],
  "attention_probs_dropout_prob": 0.1,
  "hidden_act": "gelu",
  "hidden_dropout_prob": 0.1,
  "hidden_size": 768,
  "initializer_range": 0.02,
  "intermediate_size": 3072,
  "layer_norm_eps": 1e-12,
  "max_position_embeddings": 512,
  "model_type": "bert",
  "num_attention_heads": 12,
  "num_hidden_layers": 12,
  "output_hidden_states": true,
  "pad_token_id": 0,
  "type_vocab_size": 2,
  "vocab_size": 30522
}

2020-08-13 01:39:20,877 - loading file https://s3.amazonaws.com/models.huggingface.co/bert/bert-base-uncased-vocab.txt from cache at /home/junliu/.cache/torch/transformers/26bc1ad6c0ac742e9b52263248f6d0f00068293b33709fae12320c0e35ccfbbb.542ce4285a40d23a559526243235df47c5f75c197f04f37d1a0c124c32c9a084
2020-08-13 01:39:21,057 - loading weights file https://cdn.huggingface.co/bert-base-uncased-pytorch_model.bin from cache at /home/junliu/.cache/torch/transformers/f2ee78bdd635b758cc0a12352586868bef80e47401abe4c4fcc3832421e7338b.36ca03ab34a1a5d5fa7bc3d03d55c4fa650fed07220e2eeebc06ce58d0e9a157
2020-08-13 02:25:25,763 - ***************model Info***************
2020-08-13 02:25:25,763 - model name: ../models/naivebert_layer1_en_city_model.pt
2020-08-13 02:25:25,763 - epoches: 20
2020-08-13 02:25:25,763 - hidden dimensions: 128
2020-08-13 02:25:25,763 - layers: 1
2020-08-13 02:25:25,763 - dropout: 0.25
2020-08-13 02:25:25,763 - batch size: 10
2020-08-13 02:25:25,763 - ****************************************
2020-08-13 02:25:27,462 - The model has 927,519 trainable parameters
2020-08-13 02:27:15,421 - Epoch: 01 | Epoch Time: 1m 47s
2020-08-13 02:27:15,421 - 	Train Loss: 0.904 | Train micro-f1: 76.60% | Train mAP: 58.99%
2020-08-13 02:27:15,422 - 	Val.  Loss: 0.786 | Val.  micro-f1: 78.66% | Val.  mAP: 66.85%
2020-08-13 02:29:07,907 - Epoch: 02 | Epoch Time: 1m 52s
2020-08-13 02:29:07,907 - 	Train Loss: 0.725 | Train micro-f1: 80.42% | Train mAP: 66.49%
2020-08-13 02:29:07,907 - 	Val.  Loss: 0.728 | Val.  micro-f1: 80.21% | Val.  mAP: 68.44%
2020-08-13 02:31:00,060 - Epoch: 03 | Epoch Time: 1m 52s
2020-08-13 02:31:00,060 - 	Train Loss: 0.667 | Train micro-f1: 81.62% | Train mAP: 68.60%
2020-08-13 02:31:00,061 - 	Val.  Loss: 0.723 | Val.  micro-f1: 80.55% | Val.  mAP: 69.94%
2020-08-13 02:32:51,853 - Epoch: 04 | Epoch Time: 1m 51s
2020-08-13 02:32:51,853 - 	Train Loss: 0.625 | Train micro-f1: 82.59% | Train mAP: 69.96%
2020-08-13 02:32:51,853 - 	Val.  Loss: 0.696 | Val.  micro-f1: 80.87% | Val.  mAP: 70.24%
2020-08-13 02:34:43,485 - Epoch: 05 | Epoch Time: 1m 51s
2020-08-13 02:34:43,485 - 	Train Loss: 0.586 | Train micro-f1: 83.48% | Train mAP: 71.32%
2020-08-13 02:34:43,485 - 	Val.  Loss: 0.696 | Val.  micro-f1: 80.78% | Val.  mAP: 70.34%
2020-08-13 02:36:16,052 - Epoch: 06 | Epoch Time: 1m 32s
2020-08-13 02:36:16,052 - 	Train Loss: 0.547 | Train micro-f1: 84.36% | Train mAP: 72.40%
2020-08-13 02:36:16,052 - 	Val.  Loss: 0.691 | Val.  micro-f1: 81.15% | Val.  mAP: 70.46%
2020-08-13 02:37:57,861 - Epoch: 07 | Epoch Time: 1m 41s
2020-08-13 02:37:57,862 - 	Train Loss: 0.511 | Train micro-f1: 85.20% | Train mAP: 73.31%
2020-08-13 02:37:57,862 - 	Val.  Loss: 0.714 | Val.  micro-f1: 80.61% | Val.  mAP: 70.37%
2020-08-13 02:39:50,912 - Epoch: 08 | Epoch Time: 1m 53s
2020-08-13 02:39:50,912 - 	Train Loss: 0.471 | Train micro-f1: 86.23% | Train mAP: 74.29%
2020-08-13 02:39:50,912 - 	Val.  Loss: 0.714 | Val.  micro-f1: 80.94% | Val.  mAP: 70.67%
2020-08-13 02:41:42,831 - Epoch: 09 | Epoch Time: 1m 51s
2020-08-13 02:41:42,831 - 	Train Loss: 0.436 | Train micro-f1: 87.21% | Train mAP: 75.30%
2020-08-13 02:41:42,831 - 	Val.  Loss: 0.743 | Val.  micro-f1: 80.86% | Val.  mAP: 69.93%
2020-08-13 02:43:34,734 - Epoch: 10 | Epoch Time: 1m 51s
2020-08-13 02:43:34,734 - 	Train Loss: 0.396 | Train micro-f1: 88.31% | Train mAP: 76.13%
2020-08-13 02:43:34,734 - 	Val.  Loss: 0.783 | Val.  micro-f1: 79.93% | Val.  mAP: 69.57%
2020-08-13 02:45:26,790 - Epoch: 11 | Epoch Time: 1m 52s
2020-08-13 02:45:26,790 - 	Train Loss: 0.363 | Train micro-f1: 89.18% | Train mAP: 77.24%
2020-08-13 02:45:26,790 - 	Val.  Loss: 0.786 | Val.  micro-f1: 80.23% | Val.  mAP: 70.14%
2020-08-13 02:47:15,360 - Epoch: 12 | Epoch Time: 1m 48s
2020-08-13 02:47:15,360 - 	Train Loss: 0.333 | Train micro-f1: 90.05% | Train mAP: 78.06%
2020-08-13 02:47:15,360 - 	Val.  Loss: 0.836 | Val.  micro-f1: 80.01% | Val.  mAP: 69.09%
2020-08-13 02:49:07,209 - Epoch: 13 | Epoch Time: 1m 51s
2020-08-13 02:49:07,209 - 	Train Loss: 0.301 | Train micro-f1: 90.92% | Train mAP: 79.35%
2020-08-13 02:49:07,209 - 	Val.  Loss: 0.839 | Val.  micro-f1: 79.52% | Val.  mAP: 69.12%
2020-08-13 02:50:58,807 - Epoch: 14 | Epoch Time: 1m 51s
2020-08-13 02:50:58,807 - 	Train Loss: 0.276 | Train micro-f1: 91.61% | Train mAP: 79.93%
2020-08-13 02:50:58,807 - 	Val.  Loss: 0.873 | Val.  micro-f1: 79.20% | Val.  mAP: 68.53%
2020-08-13 02:52:50,365 - Epoch: 15 | Epoch Time: 1m 51s
2020-08-13 02:52:50,365 - 	Train Loss: 0.256 | Train micro-f1: 92.17% | Train mAP: 80.67%
2020-08-13 02:52:50,365 - 	Val.  Loss: 0.894 | Val.  micro-f1: 79.91% | Val.  mAP: 69.31%
2020-08-13 02:54:28,293 - Epoch: 16 | Epoch Time: 1m 37s
2020-08-13 02:54:28,294 - 	Train Loss: 0.234 | Train micro-f1: 92.79% | Train mAP: 81.59%
2020-08-13 02:54:28,294 - 	Val.  Loss: 0.929 | Val.  micro-f1: 79.23% | Val.  mAP: 69.07%
2020-08-13 02:56:05,953 - Epoch: 17 | Epoch Time: 1m 37s
2020-08-13 02:56:05,953 - 	Train Loss: 0.221 | Train micro-f1: 93.16% | Train mAP: 82.07%
2020-08-13 02:56:05,953 - 	Val.  Loss: 0.933 | Val.  micro-f1: 79.52% | Val.  mAP: 68.79%
2020-08-13 02:57:53,559 - Epoch: 18 | Epoch Time: 1m 47s
2020-08-13 02:57:53,559 - 	Train Loss: 0.207 | Train micro-f1: 93.59% | Train mAP: 82.66%
2020-08-13 02:57:53,559 - 	Val.  Loss: 0.943 | Val.  micro-f1: 80.00% | Val.  mAP: 69.08%
2020-08-13 02:59:46,497 - Epoch: 19 | Epoch Time: 1m 52s
2020-08-13 02:59:46,497 - 	Train Loss: 0.186 | Train micro-f1: 94.18% | Train mAP: 83.61%
2020-08-13 02:59:46,497 - 	Val.  Loss: 0.976 | Val.  micro-f1: 79.77% | Val.  mAP: 68.73%
2020-08-13 03:01:39,997 - Epoch: 20 | Epoch Time: 1m 53s
2020-08-13 03:01:39,998 - 	Train Loss: 0.179 | Train micro-f1: 94.40% | Train mAP: 84.05%
2020-08-13 03:01:39,998 - 	Val.  Loss: 0.993 | Val.  micro-f1: 80.04% | Val.  mAP: 68.57%
2020-08-13 03:02:04,358 - ***************Test Set Result***************
2020-08-13 03:02:04,358 - 	Val.  Loss: 0.687 | Val.  micro-f1: 81.13% | Val.  mAP: 70.38%
2020-08-13 03:02:04,358 - *********************************************
