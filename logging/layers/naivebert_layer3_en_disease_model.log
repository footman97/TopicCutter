2020-08-12 14:31:21,568 - PyTorch version 1.4.0 available.
2020-08-12 14:31:22,028 - loading configuration file https://s3.amazonaws.com/models.huggingface.co/bert/bert-base-uncased-config.json from cache at /home/junliu/.cache/torch/transformers/4dad0251492946e18ac39290fcfe91b89d370fee250efe9521476438fe8ca185.7156163d5fdc189c3016baca0775ffce230789d7fa2a42ef516483e4ca884517
2020-08-12 14:31:22,029 - Model config BertConfig {
  "architectures": [
    "BertForMaskedLM"
  ],
  "attention_probs_dropout_prob": 0.1,
  "hidden_act": "gelu",
  "hidden_dropout_prob": 0.1,
  "hidden_size": 768,
  "initializer_range": 0.02,
  "intermediate_size": 3072,
  "layer_norm_eps": 1e-12,
  "max_position_embeddings": 512,
  "model_type": "bert",
  "num_attention_heads": 12,
  "num_hidden_layers": 12,
  "output_hidden_states": true,
  "pad_token_id": 0,
  "type_vocab_size": 2,
  "vocab_size": 30522
}

2020-08-12 14:31:22,399 - loading file https://s3.amazonaws.com/models.huggingface.co/bert/bert-base-uncased-vocab.txt from cache at /home/junliu/.cache/torch/transformers/26bc1ad6c0ac742e9b52263248f6d0f00068293b33709fae12320c0e35ccfbbb.542ce4285a40d23a559526243235df47c5f75c197f04f37d1a0c124c32c9a084
2020-08-12 14:31:22,487 - loading weights file https://cdn.huggingface.co/bert-base-uncased-pytorch_model.bin from cache at /home/junliu/.cache/torch/transformers/f2ee78bdd635b758cc0a12352586868bef80e47401abe4c4fcc3832421e7338b.36ca03ab34a1a5d5fa7bc3d03d55c4fa650fed07220e2eeebc06ce58d0e9a157
2020-08-12 15:02:16,931 - loading configuration file https://s3.amazonaws.com/models.huggingface.co/bert/bert-base-uncased-config.json from cache at /home/junliu/.cache/torch/transformers/4dad0251492946e18ac39290fcfe91b89d370fee250efe9521476438fe8ca185.7156163d5fdc189c3016baca0775ffce230789d7fa2a42ef516483e4ca884517
2020-08-12 15:02:16,932 - Model config BertConfig {
  "architectures": [
    "BertForMaskedLM"
  ],
  "attention_probs_dropout_prob": 0.1,
  "hidden_act": "gelu",
  "hidden_dropout_prob": 0.1,
  "hidden_size": 768,
  "initializer_range": 0.02,
  "intermediate_size": 3072,
  "layer_norm_eps": 1e-12,
  "max_position_embeddings": 512,
  "model_type": "bert",
  "num_attention_heads": 12,
  "num_hidden_layers": 12,
  "output_hidden_states": true,
  "pad_token_id": 0,
  "type_vocab_size": 2,
  "vocab_size": 30522
}

2020-08-12 15:02:17,328 - loading file https://s3.amazonaws.com/models.huggingface.co/bert/bert-base-uncased-vocab.txt from cache at /home/junliu/.cache/torch/transformers/26bc1ad6c0ac742e9b52263248f6d0f00068293b33709fae12320c0e35ccfbbb.542ce4285a40d23a559526243235df47c5f75c197f04f37d1a0c124c32c9a084
2020-08-12 15:02:17,551 - loading weights file https://cdn.huggingface.co/bert-base-uncased-pytorch_model.bin from cache at /home/junliu/.cache/torch/transformers/f2ee78bdd635b758cc0a12352586868bef80e47401abe4c4fcc3832421e7338b.36ca03ab34a1a5d5fa7bc3d03d55c4fa650fed07220e2eeebc06ce58d0e9a157
2020-08-12 15:06:44,817 - loading configuration file https://s3.amazonaws.com/models.huggingface.co/bert/bert-base-uncased-config.json from cache at /home/junliu/.cache/torch/transformers/4dad0251492946e18ac39290fcfe91b89d370fee250efe9521476438fe8ca185.7156163d5fdc189c3016baca0775ffce230789d7fa2a42ef516483e4ca884517
2020-08-12 15:06:44,819 - Model config BertConfig {
  "architectures": [
    "BertForMaskedLM"
  ],
  "attention_probs_dropout_prob": 0.1,
  "hidden_act": "gelu",
  "hidden_dropout_prob": 0.1,
  "hidden_size": 768,
  "initializer_range": 0.02,
  "intermediate_size": 3072,
  "layer_norm_eps": 1e-12,
  "max_position_embeddings": 512,
  "model_type": "bert",
  "num_attention_heads": 12,
  "num_hidden_layers": 12,
  "output_hidden_states": true,
  "pad_token_id": 0,
  "type_vocab_size": 2,
  "vocab_size": 30522
}

2020-08-12 15:06:45,198 - loading file https://s3.amazonaws.com/models.huggingface.co/bert/bert-base-uncased-vocab.txt from cache at /home/junliu/.cache/torch/transformers/26bc1ad6c0ac742e9b52263248f6d0f00068293b33709fae12320c0e35ccfbbb.542ce4285a40d23a559526243235df47c5f75c197f04f37d1a0c124c32c9a084
2020-08-12 15:06:45,313 - loading weights file https://cdn.huggingface.co/bert-base-uncased-pytorch_model.bin from cache at /home/junliu/.cache/torch/transformers/f2ee78bdd635b758cc0a12352586868bef80e47401abe4c4fcc3832421e7338b.36ca03ab34a1a5d5fa7bc3d03d55c4fa650fed07220e2eeebc06ce58d0e9a157
2020-08-12 15:15:18,052 - ***************model Info***************
2020-08-12 15:15:18,052 - model name: ../models/naivebert_layer3_en_disease_model.pt
2020-08-12 15:15:18,052 - epoches: 20
2020-08-12 15:15:18,052 - hidden dimensions: 128
2020-08-12 15:15:18,052 - layers: 1
2020-08-12 15:15:18,052 - dropout: 0.25
2020-08-12 15:15:18,052 - batch size: 5
2020-08-12 15:15:18,052 - ****************************************
2020-08-12 15:15:19,696 - The model has 926,748 trainable parameters
2020-08-12 15:15:53,957 - Epoch: 01 | Epoch Time: 0m 34s
2020-08-12 15:15:53,957 - 	Train Loss: 1.948 | Train micro-f1: 42.91% | Train mAP: 40.85%
2020-08-12 15:15:53,957 - 	Val.  Loss: 1.709 | Val.  micro-f1: 48.74% | Val.  mAP: 51.16%
2020-08-12 15:16:27,639 - Epoch: 02 | Epoch Time: 0m 33s
2020-08-12 15:16:27,639 - 	Train Loss: 1.589 | Train micro-f1: 52.04% | Train mAP: 52.18%
2020-08-12 15:16:27,640 - 	Val.  Loss: 1.563 | Val.  micro-f1: 52.61% | Val.  mAP: 55.01%
2020-08-12 15:17:02,010 - Epoch: 03 | Epoch Time: 0m 34s
2020-08-12 15:17:02,010 - 	Train Loss: 1.461 | Train micro-f1: 55.13% | Train mAP: 55.41%
2020-08-12 15:17:02,010 - 	Val.  Loss: 1.541 | Val.  micro-f1: 54.87% | Val.  mAP: 55.77%
2020-08-12 15:17:35,405 - Epoch: 04 | Epoch Time: 0m 33s
2020-08-12 15:17:35,406 - 	Train Loss: 1.372 | Train micro-f1: 57.66% | Train mAP: 57.12%
2020-08-12 15:17:35,406 - 	Val.  Loss: 1.449 | Val.  micro-f1: 56.01% | Val.  mAP: 58.86%
2020-08-12 15:18:09,465 - Epoch: 05 | Epoch Time: 0m 34s
2020-08-12 15:18:09,465 - 	Train Loss: 1.290 | Train micro-f1: 59.95% | Train mAP: 59.57%
2020-08-12 15:18:09,465 - 	Val.  Loss: 1.450 | Val.  micro-f1: 55.56% | Val.  mAP: 59.60%
2020-08-12 15:18:43,225 - Epoch: 06 | Epoch Time: 0m 33s
2020-08-12 15:18:43,226 - 	Train Loss: 1.212 | Train micro-f1: 61.91% | Train mAP: 60.65%
2020-08-12 15:18:43,226 - 	Val.  Loss: 1.447 | Val.  micro-f1: 56.69% | Val.  mAP: 60.05%
2020-08-12 15:19:17,135 - Epoch: 07 | Epoch Time: 0m 33s
2020-08-12 15:19:17,135 - 	Train Loss: 1.181 | Train micro-f1: 63.09% | Train mAP: 62.17%
2020-08-12 15:19:17,135 - 	Val.  Loss: 1.426 | Val.  micro-f1: 57.37% | Val.  mAP: 59.56%
2020-08-12 15:19:50,953 - Epoch: 08 | Epoch Time: 0m 33s
2020-08-12 15:19:50,953 - 	Train Loss: 1.116 | Train micro-f1: 65.05% | Train mAP: 63.04%
2020-08-12 15:19:50,953 - 	Val.  Loss: 1.438 | Val.  micro-f1: 58.41% | Val.  mAP: 60.29%
2020-08-12 15:20:24,793 - Epoch: 09 | Epoch Time: 0m 33s
2020-08-12 15:20:24,794 - 	Train Loss: 1.075 | Train micro-f1: 65.98% | Train mAP: 64.43%
2020-08-12 15:20:24,794 - 	Val.  Loss: 1.393 | Val.  micro-f1: 59.18% | Val.  mAP: 61.22%
2020-08-12 15:20:58,685 - Epoch: 10 | Epoch Time: 0m 33s
2020-08-12 15:20:58,685 - 	Train Loss: 1.009 | Train micro-f1: 67.91% | Train mAP: 65.46%
2020-08-12 15:20:58,685 - 	Val.  Loss: 1.509 | Val.  micro-f1: 56.09% | Val.  mAP: 61.35%
2020-08-12 15:21:32,409 - Epoch: 11 | Epoch Time: 0m 33s
2020-08-12 15:21:32,410 - 	Train Loss: 0.948 | Train micro-f1: 69.92% | Train mAP: 66.83%
2020-08-12 15:21:32,410 - 	Val.  Loss: 1.514 | Val.  micro-f1: 55.14% | Val.  mAP: 60.10%
2020-08-12 15:22:06,299 - Epoch: 12 | Epoch Time: 0m 33s
2020-08-12 15:22:06,299 - 	Train Loss: 0.886 | Train micro-f1: 71.66% | Train mAP: 68.23%
2020-08-12 15:22:06,299 - 	Val.  Loss: 1.369 | Val.  micro-f1: 59.34% | Val.  mAP: 62.33%
2020-08-12 15:22:40,480 - Epoch: 13 | Epoch Time: 0m 34s
2020-08-12 15:22:40,481 - 	Train Loss: 0.816 | Train micro-f1: 74.19% | Train mAP: 69.39%
2020-08-12 15:22:40,481 - 	Val.  Loss: 1.412 | Val.  micro-f1: 59.84% | Val.  mAP: 60.48%
2020-08-12 15:23:06,496 - Epoch: 14 | Epoch Time: 0m 26s
2020-08-12 15:23:06,496 - 	Train Loss: 0.780 | Train micro-f1: 75.07% | Train mAP: 70.56%
2020-08-12 15:23:06,496 - 	Val.  Loss: 1.450 | Val.  micro-f1: 60.00% | Val.  mAP: 60.83%
2020-08-12 15:23:31,472 - Epoch: 15 | Epoch Time: 0m 24s
2020-08-12 15:23:31,472 - 	Train Loss: 0.721 | Train micro-f1: 77.02% | Train mAP: 72.27%
2020-08-12 15:23:31,472 - 	Val.  Loss: 1.503 | Val.  micro-f1: 58.28% | Val.  mAP: 60.20%
2020-08-12 15:24:05,279 - Epoch: 16 | Epoch Time: 0m 33s
2020-08-12 15:24:05,279 - 	Train Loss: 0.659 | Train micro-f1: 79.12% | Train mAP: 73.15%
2020-08-12 15:24:05,279 - 	Val.  Loss: 1.549 | Val.  micro-f1: 58.03% | Val.  mAP: 60.25%
2020-08-12 15:24:34,396 - Epoch: 17 | Epoch Time: 0m 29s
2020-08-12 15:24:34,397 - 	Train Loss: 0.604 | Train micro-f1: 80.88% | Train mAP: 74.62%
2020-08-12 15:24:34,397 - 	Val.  Loss: 1.711 | Val.  micro-f1: 56.79% | Val.  mAP: 60.51%
2020-08-12 15:25:07,404 - Epoch: 18 | Epoch Time: 0m 33s
2020-08-12 15:25:07,404 - 	Train Loss: 0.550 | Train micro-f1: 82.70% | Train mAP: 76.15%
2020-08-12 15:25:07,404 - 	Val.  Loss: 1.669 | Val.  micro-f1: 57.00% | Val.  mAP: 61.07%
2020-08-12 15:25:41,209 - Epoch: 19 | Epoch Time: 0m 33s
2020-08-12 15:25:41,209 - 	Train Loss: 0.522 | Train micro-f1: 83.51% | Train mAP: 77.13%
2020-08-12 15:25:41,209 - 	Val.  Loss: 1.605 | Val.  micro-f1: 58.57% | Val.  mAP: 61.03%
2020-08-12 15:26:14,789 - Epoch: 20 | Epoch Time: 0m 33s
2020-08-12 15:26:14,789 - 	Train Loss: 0.476 | Train micro-f1: 84.92% | Train mAP: 78.09%
2020-08-12 15:26:14,789 - 	Val.  Loss: 1.660 | Val.  micro-f1: 58.50% | Val.  mAP: 60.71%
2020-08-12 15:26:21,615 - ***************Test Set Result***************
2020-08-12 15:26:21,615 - 	Val.  Loss: 1.470 | Val.  micro-f1: 57.04% | Val.  mAP: 61.30%
2020-08-12 15:26:21,615 - *********************************************
